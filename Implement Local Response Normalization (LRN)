import numpy as np

def local_response_normalization(
    x: np.ndarray,
    n: int = 5,
    k: float = 2.0,
    alpha: float = 1e-4,
    beta: float = 0.75
) -> np.ndarray:
    """
    Applies Local Response Normalization (LRN) across the channel dimension.

    Args:
        x: Input tensor of shape (N, C, H, W)
        n: Local window size
        k: Additive constant
        alpha: Scaling parameter
        beta: Exponent parameter

    Returns:
        Normalized tensor of same shape as input.
    """
    if not isinstance(x, np.ndarray) or x.ndim != 4:
        raise ValueError("Input must be a 4D NumPy array (N, C, H, W)")

    N, C, H, W = x.shape
    half_n = n // 2

    x_sq = x ** 2

    scale = np.zeros_like(x)

    for c in range(C):
        start = max(0, c - half_n)
        end = min(C, c + half_n + 1)
        scale[:, c, :, :] = np.sum(x_sq[:, start:end, :, :], axis=1)

    scale = (k + (alpha / n) * scale) ** beta
    return x / scale
