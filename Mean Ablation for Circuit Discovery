import numpy as np

def mean_ablate(activations: np.ndarray, mask: np.ndarray, means: np.ndarray) -> np.ndarray:
    """
    Apply mean ablation to node activations.
    
    Args:
        activations: Original node activations, shape (n,) or (batch, n)
        mask: Binary mask where 1 = ablate (replace with mean), shape (n,)
        means: Precomputed mean activations for each node, shape (n,)
    
    Returns:
        Ablated activations with same shape as input
    """
    activations = np.asarray(activations)
    mask = np.asarray(mask)
    means = np.asarray(means)

    if activations.ndim == 2:
        mask = mask[np.newaxis, :]
        means = means[np.newaxis, :]

    return activations * (1 - mask) + means * mask
